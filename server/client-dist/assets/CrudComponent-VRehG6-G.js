import{j as t,r as f,B as x}from"./index-ymt4ANV3.js";import{D as q}from"./DynamicForm-f4og165E.js";import{b as S}from"./Combination-SEgVTcLS.js";import{D as z}from"./columnFields-cl43BhCr.js";import{M as F}from"./Modal-STHToa6U.js";import{a as C}from"./axiosInstance-PK0LAldn.js";const G=({label:h,onPress:j,btnLabel:p,description:i})=>t.jsxs("div",{className:"w-full flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-semibold",children:h}),t.jsx("p",{children:i})]}),p&&t.jsx(S,{className:"text-default-50",onPress:j,children:p})]}),ee=({headerBtnLabel:h,headerDescription:j,headerLabel:p,formFields:i,formHeader:w,tableColumns:D,formValidationSchema:$,submitButtonLabel:B="Add",columnRenderers:M,api:P,crudApi:r,queryKey:R,tableRowClassName:E,onSubmitSuccess:N,onDeleteSuccess:I,beforeTableComponent:W,disableDelete:g,disableEdit:b,defaultSortDescriptor:k})=>{const[A,d]=f.useState(!1),[H,O]=f.useState(0),[L,v]=f.useState(!1),[c,o]=f.useState(null),[T,y]=f.useState(!1),V=e=>{const n=Object.keys(e).reduce((s,a)=>(s={...s,[a]:e[a]},s),{});y(!0),r&&(c?C.put(`${r}${c.id}`,n):C.post(`${r}`,n)).then(s=>{var a;console.log(s.data),x.success((a=s.data)==null?void 0:a.message),d(!1),O(l=>l+1),o(null),y(!1),N&&N()}).catch(s=>{var a,l,m;y(!1),x.error(t.jsx("div",{children:((m=(l=(a=s==null?void 0:s.response)==null?void 0:a.data)==null?void 0:l.errors)==null?void 0:m.map(u=>t.jsx("p",{children:u.msg},u.msg)))??(s==null?void 0:s.message)}))})},Y=()=>{c&&C.delete(`${r}${c.id}`).then(e=>{var n;x.success((n=e.data)==null?void 0:n.message),o(null),v(!1),O(s=>s+1),I&&I()}).catch(e=>{var n,s,a,l,m;x.error(t.jsx("div",{children:((a=(s=(n=e==null?void 0:e.response)==null?void 0:n.data)==null?void 0:s.errors)==null?void 0:a.map(u=>t.jsx("p",{children:u.msg},u.msg)))??((m=(l=e==null?void 0:e.response)==null?void 0:l.data)==null?void 0:m.message)??(e==null?void 0:e.message)}))})},_=(e,n)=>{o(n),e==="delete"?v(!0):e==="edit"&&d(!0)};return t.jsxs("div",{children:[t.jsx("div",{className:"flex",children:t.jsx(G,{label:p,description:j,btnLabel:i?h:void 0,onPress:()=>{o(null),d(!0)}})}),i&&A&&t.jsx(q,{fields:i,validationSchema:$,initialValues:c,onSubmit:V,onOpenChange:()=>d(!1),formHeader:w,submitButtonLabel:B,fieldsWrapperClassName:"gap-0",buttonWrapperClassName:"justify-start items-center flex-row-reverse gap-3",submitButtonProps:{isDisabled:T},otherFooterElements:t.jsx(S,{color:"danger",variant:"flat",onPress:()=>{d(!1),o(null)},children:"Close"})}),W,t.jsx(z,{columns:D,columnRenderers:M,api:P,queryKey:R,refetchNum:H,tableRowClassName:E,actionItems:[{key:"edit",label:"Edit"},{key:"delete",label:"Delete",color:"danger",className:"text-danger"}],onRowAction:_,dropdownDisabledeys:e=>[...(typeof b=="function"?b(e):b)?["edit"]:[],...(typeof g=="function"?g(e):g)?["delete"]:[]],defaultSortDescriptor:k}),t.jsx(F,{isOpen:L,handleClose:()=>{o(null),v(!1)},header:"Confirm",confirmBtnAction:Y,confirmBtnLabel:"Yes",body:"Are you sure you want to delete this item?"})]})};export{ee as C};
