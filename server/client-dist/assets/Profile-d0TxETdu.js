import{r as n,j as a,J as K,u as H,K as J,B as R,M as q}from"./index-O9JJZrcZ.js";import{B as G,a as k}from"./index-oRVazuJU.js";import{a as Q}from"./index-bKknQNN6.js";import{u as X,a as E}from"./user-74mMtnoU.js";import{D as ee}from"./DynamicForm-T-cbPcn0.js";import{f as ae,p as se,n as te,g as re,h as oe,j as le}from"./validations-w-brqqe0.js";import{a as C}from"./axiosInstance-PK0LAldn.js";import{e as I}from"./index-3bZUMnvO.js";import{M as ie}from"./Modal-JrmTqVSx.js";import{u as ne}from"./useCurrency-3NVBnG5b.js";import{t as de,a as me,u as ce,c as W,e as F,f as pe}from"./constants-lrUcu3Dc.js";import"./Input-Q0zpkvv3.js";import"./Combination-wQBSQ2xP.js";var T=de({slots:{wrapper:"relative shadow-black/5",zoomedWrapper:"relative overflow-hidden rounded-inherit",img:"relative z-10 opacity-0 shadow-black/5 data-[loaded=true]:opacity-100",blurredImg:["absolute","z-0","inset-0","w-full","h-full","object-cover","filter","blur-lg","scale-105","saturate-150","opacity-30","translate-y-1"]},variants:{radius:{none:{},sm:{},md:{},lg:{},full:{}},shadow:{none:{wrapper:"shadow-none",img:"shadow-none"},sm:{wrapper:"shadow-small",img:"shadow-small"},md:{wrapper:"shadow-medium",img:"shadow-medium"},lg:{wrapper:"shadow-large",img:"shadow-large"}},isZoomed:{true:{img:["object-cover","transform","hover:scale-125"]}},showSkeleton:{true:{wrapper:["group","relative","overflow-hidden","bg-content3 dark:bg-content2","before:opacity-100","before:absolute","before:inset-0","before:-translate-x-full","before:animate-[shimmer_2s_infinite]","before:border-t","before:border-content4/30","before:bg-gradient-to-r","before:from-transparent","before:via-content4","dark:before:via-default-700/10","before:to-transparent","after:opacity-100","after:absolute","after:inset-0","after:-z-10","after:bg-content3","dark:after:bg-content2"],img:"opacity-0"}},disableAnimation:{true:{img:"transition-none"},false:{img:"transition-transform-opacity motion-reduce:transition-none !duration-300"}}},defaultVariants:{radius:"lg",shadow:"none",isZoomed:!1,isBlurred:!1,showSkeleton:!1,disableAnimation:!1},compoundSlots:[{slots:["wrapper","img","blurredImg","zoomedWrapper"],radius:"none",class:"rounded-none"},{slots:["wrapper","img","blurredImg","zoomedWrapper"],radius:"full",class:"rounded-full"},{slots:["wrapper","img","blurredImg","zoomedWrapper"],radius:"sm",class:"rounded-small"},{slots:["wrapper","img","blurredImg","zoomedWrapper"],radius:"md",class:"rounded-md"},{slots:["wrapper","img","blurredImg","zoomedWrapper"],radius:"lg",class:"rounded-large"}]});function ue(h){const[i,m]=me(h,T.variantKeys),{ref:x,as:d,src:o,className:v,classNames:t,loading:w,isBlurred:u,fallbackSrc:c,isLoading:f,disableSkeleton:b=!!c,removeWrapper:e=!1,onError:r,onLoad:g,srcSet:S,sizes:U,crossOrigin:P,...s}=i,l=X({src:o,loading:w,onError:r,onLoad:g,ignoreFallback:!1,srcSet:S,sizes:U,crossOrigin:P}),p=l==="loaded"&&!f,j=l==="loading"||f,_=h.isZoomed,$=d||"img",A=ce(x),{w:O}=n.useMemo(()=>({w:i.width?typeof i.width=="number"?`${i.width}px`:i.width:"fit-content"}),[i==null?void 0:i.width]),z=(!o||!p)&&!!c,D=j&&!b,N=n.useMemo(()=>T({...m,showSkeleton:D}),[...Object.values(m),D]),M=W(v,t==null?void 0:t.img),L=(y={})=>{const V=W(M,y==null?void 0:y.className);return{src:o,ref:A,"data-loaded":F(p),className:N.img({class:V}),loading:w,srcSet:S,sizes:U,crossOrigin:P,...s}},Y=n.useCallback(()=>{const y=z?{backgroundImage:`url(${c})`}:{};return{className:N.wrapper({class:t==null?void 0:t.wrapper}),style:{...y,maxWidth:O}}},[N,z,c,t==null?void 0:t.wrapper]),Z=n.useCallback(()=>({src:o,"aria-hidden":F(!0),className:N.blurredImg({class:t==null?void 0:t.blurredImg})}),[N,o,t==null?void 0:t.blurredImg]);return{Component:$,domRef:A,slots:N,classNames:t,isBlurred:u,disableSkeleton:b,fallbackSrc:c,removeWrapper:e,isZoomed:_,isLoading:j,getImgProps:L,getWrapperProps:Y,getBlurredImgProps:Z}}var B=pe((h,i)=>{const{Component:m,domRef:x,slots:d,classNames:o,isBlurred:v,isZoomed:t,fallbackSrc:w,removeWrapper:u,disableSkeleton:c,getImgProps:f,getWrapperProps:b,getBlurredImgProps:e}=ue({...h,ref:i}),r=a.jsx(m,{ref:x,...f()});if(u)return r;const g=a.jsx("div",{className:d.zoomedWrapper({class:o==null?void 0:o.zoomedWrapper}),children:r});return v?a.jsxs("div",{...b(),children:[t?g:r,n.cloneElement(r,e())]}):t||!c||w?a.jsxs("div",{...b(),children:[" ",t?g:r]}):r});B.displayName="NextUI.Image";var fe=B;const Ie=()=>{const h=n.useRef(null),i=n.useRef(null),[m,x]=n.useState(),[d,o]=n.useState(null),[v,t]=n.useState(!1),[w,u]=n.useState({}),[c,f]=n.useState(!1),b=K(),e=H(J);n.useEffect(()=>{if(m&&FileReader){const s=new FileReader;s.onload=function(){i.current.src=s.result},s.readAsDataURL(m)}else m||(i.current.src=e!=null&&e.imageUrl?`https://expense-app-39i5.onrender.com/${e==null?void 0:e.imageUrl}`:E)},[m,e]);const r=ne(),g=()=>C.get("/api/user/profile").then(s=>s.data.data).then(s=>{b(q(s))}).catch(s=>{t(!1),I(s)}),S=s=>{let l=d==="PASSWORD_UPDATE"?{password:s.password}:s;C.patch("/api/user/update-profile",l).then(p=>{var j;R.success((j=p.data)==null?void 0:j.message),o(null),u({}),t(!1),g()}).catch(p=>{t(!1),I(p)})},U=s=>{x(s),C.post("/api/user/profile-image",{imageUrl:s},{headers:{"Content-Type":"multipart/form-data"}}).then(l=>{var p;R.success((p=l.data)==null?void 0:p.message),g()}).catch(l=>{I(l)})},P=()=>{C.delete("/api/user/profile-image").then(s=>{var l;R.success((l=s.data)==null?void 0:l.message),x(void 0),f(!1),g()}).catch(s=>{I(s)})};return a.jsxs("div",{children:[a.jsxs("div",{className:"flex gap-5",children:[a.jsxs("div",{className:"group relative w-1/2 max-w-[300px] h-[200px]",children:[a.jsxs("div",{className:"group-hover:bg-[rgba(0,0,0,0.4)] w-full h-0 group-hover:h-full transition-all absolute overflow-hidden flex justify-center items-center gap-5 z-[100] rounded-lg",children:[a.jsx(G,{size:60,className:"text-default-600 p-2 cursor-pointer",onClick:()=>{var s;(s=h.current)==null||s.click()}}),(e==null?void 0:e.imageUrl)&&a.jsx(Q,{size:28,className:"absolute cursor-pointer text-danger-700 top-3 right-3",onClick:()=>f(!0)})]}),a.jsx(fe,{ref:i,classNames:{wrapper:"!w-full h-full !max-w-[400px]"},alt:"NextUI hero Image with delay",className:`w-full transition-all border-2 border-default-200 h-full opacity-100 ${m||e!=null&&e.imageUrl?"object-cover":""}`,src:e!=null&&e.imageUrl?`https://expense-app-39i5.onrender.com/${e==null?void 0:e.imageUrl}`:E}),a.jsx("input",{type:"file",ref:h,className:"hidden",onChange:s=>{var l;return U((l=s.target.files)==null?void 0:l[0])}})]}),a.jsxs("div",{className:"border-2 border-default-200 rounded-md flex-1 p-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-bold text-default-400",children:"Name"}),a.jsxs("p",{className:"text-bold capitalize flex gap-3 items-center",children:[`${e==null?void 0:e.firstName} ${e==null?void 0:e.lastName}`,a.jsx(k,{className:"text-default-400 cursor-pointer",size:18,onClick:()=>{o("NAME_UPDATE"),u({firstName:e==null?void 0:e.firstName,lastName:e==null?void 0:e.lastName})}})]})]}),(e==null?void 0:e.email)&&a.jsxs("div",{className:"mt-8",children:[a.jsx("p",{className:"text-bold text-default-400",children:"Email"}),a.jsx("p",{className:"text-bold capitalize",children:`${(e==null?void 0:e.email)??"-"}`})]}),(e==null?void 0:e.phone)&&a.jsxs("div",{className:"mt-8",children:[a.jsx("p",{className:"text-bold text-default-400",children:"Phone"}),a.jsx("p",{className:"text-bold capitalize",children:`${e==null?void 0:e.countryCode}-${e==null?void 0:e.phone}`})]})]})]}),a.jsxs("div",{className:"border-2 border-default-200 rounded-md mt-10 p-3",children:[a.jsx("p",{className:"text-xl mb-4 border-b border-default-200 pb-1",children:"Settings"}),a.jsxs("div",{className:"flex",children:[a.jsxs("div",{className:"flex items-center flex-1 gap-3 px-3",children:[a.jsx("p",{className:"text-bold",children:"Change Password"})," ",a.jsx(k,{className:"text-default-400 cursor-pointer",size:18,onClick:()=>o("PASSWORD_UPDATE")})]}),a.jsxs("div",{className:"flex items-center flex-1 gap-3 px-3",children:[a.jsx("span",{className:"text-bold text-default-400",children:"Currency - "}),a.jsxs("span",{className:"text-bold capitalize",children:[r==null?void 0:r.code," (",r==null?void 0:r.symbol,")"]}),a.jsx(k,{className:"text-default-400 cursor-pointer",size:18,onClick:()=>{o("CURRENCY_UPDATE"),u({currency:r==null?void 0:r.code})}})]})]})]}),d&&a.jsx(ee,{fields:d==="CURRENCY_UPDATE"?ae:d==="PASSWORD_UPDATE"?se:te,validationSchema:d==="CURRENCY_UPDATE"?re:d==="PASSWORD_UPDATE"?oe:le,initialValues:w,onSubmit:S,onOpenChange:()=>{o(null),u({})},formHeader:d==="CURRENCY_UPDATE"?"Update Currency":d==="PASSWORD_UPDATE"?"Update Password":"Update Name",submitButtonProps:{isDisabled:v},submitButtonLabel:"Update"}),a.jsx(ie,{isOpen:c,handleClose:()=>{f(!1)},header:"Confirm",confirmBtnAction:P,confirmBtnLabel:"Yes",body:"Are you sure you want to delete this item?"})]})};export{Ie as default};
