import{E as g,j as a,r as x,af as E,Z as w}from"./index-s1U5AH-M.js";import{u as m,D,v as B}from"./validations-4-iiaDQp.js";import{a as P}from"./axiosInstance-XDAG8xBt.js";const O=s=>{var c,r,l,d,n;return g.error(a.jsx("div",{children:((l=(r=(c=s==null?void 0:s.response)==null?void 0:c.data)==null?void 0:r.errors)==null?void 0:l.map(t=>a.jsx("p",{children:t.msg},t.msg)))??((n=(d=s==null?void 0:s.response)==null?void 0:d.data)==null?void 0:n.message)??(s==null?void 0:s.message)??"Error"}))},L=()=>{const[s,c]=x.useState(!1),[r,l]=x.useState(!1),[d,n]=x.useState(!1),t=e=>a.jsx("div",{children:a.jsx("p",{className:"text-default cursor-pointer",onClick:()=>{var j;P.post("/api/user/resend-otp",{emailOrPhone:e==null?void 0:e.emailOrPhone,countryCode:(j=e==null?void 0:e.countryCode)==null?void 0:j.value}).then(u=>{var h;g.success((h=u.data)==null?void 0:h.message)}).catch(u=>{O(u)})},children:"Resend OTP"})}),[C,p]=x.useState([m(t)[0]]),S=(e,j,u)=>{var h,y,b;console.log("onSubmit",e),n(!0),s?r?P.post("/api/user/reset-password",{emailOrPhone:e==null?void 0:e.emailOrPhone,countryCode:(b=e==null?void 0:e.countryCode)==null?void 0:b.value,otp:e==null?void 0:e.otp,password:e==null?void 0:e.password}).then(o=>{var i;console.log("RES33333",o),u(),g.success((i=o.data)==null?void 0:i.message),n(!1),l(!1),c(!1),p([m(t)[0]])}).catch(o=>{O(o),n(!1)}):P.post("/api/user/verify-otp",{emailOrPhone:e==null?void 0:e.emailOrPhone,countryCode:(y=e==null?void 0:e.countryCode)==null?void 0:y.value,otp:e==null?void 0:e.otp}).then(o=>{var i;console.log("RES2222",o),g.success((i=o.data)==null?void 0:i.message),p(m(t).map(f=>({...f,isDisabled:["emailOrPhone","otp"].includes(f.name)}))),l(!0),n(!1)}).catch(o=>{O(o),n(!1)}):P.post("/api/user/get-otp",{emailOrPhone:e==null?void 0:e.emailOrPhone,countryCode:(h=e==null?void 0:e.countryCode)==null?void 0:h.value}).then(o=>{var i;console.log("RES",o),g.success((i=o.data)==null?void 0:i.message),p(m(t).slice(0,2).map(f=>({...f,isDisabled:f.name==="emailOrPhone"}))),c(!0),n(!1)}).catch(o=>{O(o),n(!1)})},F=()=>{r?(p(m(t).slice(0,2).map(e=>({...e,isDisabled:e.name==="emailOrPhone"}))),l(!1)):s&&(p([m(t)[0]]),c(!1))};return a.jsx("div",{className:"h-screen -mb-6 flex justify-center items-center",children:a.jsx(D,{hideCloseButton:!0,fields:C,onSubmit:S,validationSchema:B(s,r),submitButtonProps:{isLoading:d,isDisabled:d},formHeader:a.jsxs("div",{className:"justify-center pl-4",children:[s&&a.jsx(E,{className:"absolute left-4 cursor-pointer",onClick:F}),"Forgot Password"]}),submitButtonLabel:s?r?"Reset Password":"Verify OTP":"Get OTP",otherFooterElements:a.jsx(a.Fragment,{children:a.jsxs("p",{children:["Go to"," ",a.jsx(w,{to:"/login",className:"text-primary-500",children:"Login"})," ","page"]})}),buttonWrapperClassName:"justify-center items-center flex-col gap-3"})})};export{L as default};
